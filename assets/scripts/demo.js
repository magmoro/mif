var Site={	start: function(){		//this.resizer();		this.local();		this.get_scripts();		this.getRoot();		this.get_source();		//this.set_iframe();		this.resize();		hljs.initHighlighting();		this.init_info();		//this.fill_filter();		//this.get_demo_list();		//this.links();			},		getRoot: function(){		var path=document.location.href.split('#')[0];		var arr=path.split('/');		arr.pop();		this.root=arr.join('/')+'/';	},		local: function(){		Request.implement({			isSuccess: function() {				return (!this.status || (this.status >= 200) && (this.status < 300));			},			processScripts: function(text){				return text;			}		});	},		get_scripts: function(){		new Request.JSON({			url: 'scripts.json',			method: 'get',			onComplete: function(json){				this.make_menu(json);				this.attach_menu_events();			}.bind(this)		}).send();	},		make_menu: function(json){		for(var item in json){			var ul=new Element('ul', {'class': 'item'}).inject('menu');			var li=new Element('li', {'class': 'item', html: '<h2>'+item+'</h2>'}).inject(ul);			for(var subitem in json[item]){				new Element('li').inject(li).adopt(					new Element('a', {href: '#'+item+'/'+subitem+'/', html: json[item][subitem]['title']})				);			}		}	},		attach_menu_events: function(){		var self=this;		$('menu').getElements('a').each(function(el){			el.addEvent('click', function(){				self.show(el.get('href').substring(1));			});		});	},		show: function(path){		var root=this.root;		var iframe=$('iframe');		iframe.src=root+'demo.html';		var self=this;		this.get_demo(function(html, js, css){			var page=' \		<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"> \		<html xmlns="http://www.w3.org/1999/xhtml" version="-//W3C//DTD XHTML 1.1//EN" xml:lang="en"> \			<head> \			<title>test.</title>';			page+='<base href="'+root+'"></base>';			page+=self.sources+'<script type="text/javascript" src="'+root+path+'demo.js'+'"></script>';			page+='<link rel="stylesheet" type="text/css" href="'+root+path+'demo.css'+'"></link>';			page+='</head><body>'+html+'</body>';			iframe.contentWindow.document.write(page);			iframe.contentWindow.document.close();		}, path);	},		get_demo: function(complete, path){		var items=new Hash;		this.items=items;		var root=this.root;		var self=this;		function check(){			if(items.getLength()==3) complete(items.html, items.js, items.css);		}		['html', 'js', 'css'].each(function(el){			new Request({				url: root+path+'demo.'+el,				method: 'get',				onComplete: function(response){					items[el]=response;					var code=$('code_'+el).setStyle('display', 'none');					code.getFirst().set('html', '<pre class="fix">'+response.replace(/\t/g,'    ').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')+'</pre>');					hljs.highlightBlock(code.getFirst());					check();				}			}).send();		});	},		get_source: function(){		var self=this;		var resolver=new DepsResolver();		resolver.addEvent('load', function(){			this.check(this.nodes['/Mif']);			self.sources=this.getScripts(self.root+'../Source');		});		resolver.load('../Source/scripts.json');	},		fill_filter: function(){		var info={};		var hash=document.location.hash.split('#')[1];		var parts=hash.split('/');		parts.each(function(part){			var bits=part.split(':');			info[bits[0]]=bits[1].split('&').join(' ');		});		this.info=info;		$('author').value=info.author||'';		$('tag').value=info.tag||'';	},		get_demo_list: function(){		var info=this.info;		var data={			author: info.author,			tag: info.tag		}		new Request.JSON({			url: '/get/list',			onComplete: function(json){			},			method: 'post'		}).send({data:{data:JSON.encode(data)}});	},		links: function(){		$$('#menu a').addEvent('click', function(event){		})	},		resize: function(){		window.addEvent('resize', function(){			var iframe=$('iframe');			var parent=iframe.getParent();			var previous=iframe.getPrevious();			$('iframe').setStyle('height', parent.offsetHeight - previous.offsetHeight);						$('right').setStyle('width', window.getWidth()-$('left').offsetWidth);				});		window.fireEvent('resize');	},		set_iframe: function(){		var iframe=new IFrame({id: 'iframe', src: 'demo.html', 'frameBorder': 'no'});		this.iframe=iframe;		var self=this;		iframe.inject($('right'));		iframe.addEvent('load', function(){			self.resize();		});	},		init_info: function(){		var self=this;		self.current=false;		$$('.info').each(function(el){			var type=el.get('id');			var code=$('code_'+type);			el.addEvent('click', function(){				if(self.current){					$('code_'+self.current).setStyle('display', 'none')					$(self.current).removeClass('selected');					self.resize();					if(self.current==type){						self.current=false;						return;					}				}				self.current=type;				code.setStyle('display', 'block');				$(type).addClass('selected');				self.resize();			});		});			}}window.addEvent('domready', Site.start.bind(Site));