var Site={	start: function(){		//this.resizer();		this.local();		this.get_scripts();		this.getRoot();		this.get_source();		//this.set_iframe();		//this.resize();		//this.fill_filter();		//this.get_demo_list();		//this.links();			},		getRoot: function(){		var path=document.location.href.split('#')[0];		var arr=path.split('/');		arr.pop();		this.root=arr.join('/')+'/';	},		local: function(){		Request.implement({			isSuccess: function() {				return (!this.status || (this.status >= 200) && (this.status < 300));			}		});	},		get_scripts: function(){		new Request.JSON({			url: 'scripts.json',			method: 'get',			onComplete: function(json){				this.make_menu(json);				this.attach_menu_events();			}.bind(this)		}).send();	},		make_menu: function(json){		for(var item in json){			var ul=new Element('ul', {'class': 'item'}).inject('menu');			var li=new Element('li', {'class': 'item', html: '<h2>'+item+'</h2>'}).inject(ul);			for(var subitem in json[item]){				new Element('li').inject(li).adopt(					new Element('a', {href: '#'+item+'/'+subitem+'/', html: json[item][subitem]['title']})				);			}		}	},		attach_menu_events: function(){		var self=this;		$('menu').getElements('a').each(function(el){			el.addEvent('click', function(){				self.show(el.get('href').substring(1));			});		});	},		show: function(path){		var root=this.root;		var iframe=window.parent.frames[1];//this.iframe;		iframe.location.href=root+'demo.html';		new Request({			url: root+path+'demo.html',			method: 'get',			onComplete: function(html){				var page=' \		<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"> \		<html xmlns="http://www.w3.org/1999/xhtml" version="-//W3C//DTD XHTML 1.1//EN" xml:lang="en"> \			<head> \				<title>test.</title>';				page+='<base href="'+root+'"></base>';				page+=this.sources+'<script type="text/javascript" src="'+root+path+'demo.js'+'"></script>';				page+='<link rel="stylesheet" type="text/css" href="'+root+path+'demo.css'+'"></link>';				page+='</head><body>'+html+'</body>';				iframe.document.write(page);				iframe.document.close();			}.bind(this)		}).send();	},		get_source: function(){		var self=this;		var resolver=new DepsResolver();		resolver.addEvent('load', function(){			this.check(this.nodes['/Mif']);			self.sources=this.getScripts(self.root+'../Source');		});		resolver.load('../Source/scripts.json');	},		fill_filter: function(){		var info={};		var hash=document.location.hash.split('#')[1];		var parts=hash.split('/');		parts.each(function(part){			var bits=part.split(':');			info[bits[0]]=bits[1].split('&').join(' ');		});		this.info=info;		$('author').value=info.author||'';		$('tag').value=info.tag||'';	},		get_demo_list: function(){		var info=this.info;		var data={			author: info.author,			tag: info.tag		}		new Request.JSON({			url: '/get/list',			onComplete: function(json){			},			method: 'post'		}).send({data:{data:JSON.encode(data)}});	},		links: function(){		$$('#menu a').addEvent('click', function(event){		})	},		resize: function(){		window.addEvent('resize', function(){			var iframe=$('iframe');			var parent=iframe.getParent();			var previous=iframe.getPrevious();			$('iframe').setStyle('height', parent.offsetHeight - previous.offsetHeight);						$('right').setStyle('width', window.getWidth()-$('left').offsetWidth);				});		window.fireEvent('resize');	},		resizer: function(){		var resizer=new Element('div', {'class': 'resizer', 'id': 'resizer'}).inject(document.body);		var left=$('left'), right=$('right');		resizer.setStyle('left', left.offsetWidth-3);		left.setStyle('width', left.offsetWidth-3);		right.setStyle('left', left.offsetWidth);		right.setStyle('width', window.getWidth()-left.offsetWidth);				var shim=new Element('div', {'class': 'shim'}).inject(document.body).setStyle('display', 'none');		var self=this;		var resizerGhost=resizer.clone().setStyle('display', 'none').inject(document.body);		this.bound={			mousemove: function(event){				resizerGhost.setStyle('left', event.page.x);				document.title=event.page.x;			},			escape: function(event){				if(event.key!='esc') return;				resizerGhost.setStyle('display', 'none');								document.removeEvent('mousemove',self.bound.mousemove);				document.removeEvent('keydown', self.bound.escape);				document.removeEvent('mouseup', self.bound.mouseup);				document.removeEvent('mousemove', self.bound.mousemove);				shim.setStyle('display', 'none');							},			mouseup: function(event){				document.removeEvent('mousemove',self.bound.mousemove);				document.removeEvent('keydown', self.bound.escape);				document.removeEvent('mouseup', self.bound.mouseup);				shim.setStyle('display', 'none');				var resizerLeft=resizerGhost.getLeft()				left.setStyle('width', resizerLeft);				right.setStyles({					'left': resizerLeft+3,					'width': window.getWidth()-(resizerLeft+3)				});				resizer.setStyle('left', resizerLeft);				resizerGhost.setStyle('display', 'none').setStyle('z-index',10000);			}		}						resizer.addEvent('mousedown', function(event){			//shim.contentWindow.document.addEvent('mousemove', self.bound.mousemove);			document.addEvent('mousemove', self.bound.mousemove);			document.addEvent('keydown', self.bound.escape);			shim.setStyle('display', 'block');			resizerGhost.setStyle('left', event.page.x);			resizerGhost.setStyle('display', 'block');						document.addEvent('mouseup', self.bound.mouseup);			event.preventDefault();		});			},		set_iframe: function(){		var iframe=new IFrame({id: 'iframe', src: 'demo.html', 'frameBorder': 'no'});		this.iframe=iframe;		var self=this;		iframe.inject($('right'));		iframe.addEvent('load', function(){						//this.contentWindow.document.write('<script type="text/javascript" src="file:///D:/git/mif/Demo/../assets/scripts/test.js"></script><script type="text/javascript">alert(document.location)</script>1');			self.resize();		});	}}window.addEvent('domready', Site.start.bind(Site));